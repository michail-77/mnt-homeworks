# Домашнее задание к занятию 17 «Инцидент-менеджмент»

## Задание

Составьте постмортем на основе реального сбоя системы GitHub в 2018 году.

Информацию о сбое можно изучить по ссылкам ниже:

* [краткое описание на русском языке](https://habr.com/ru/post/427301/);
* [развёрнутое описание на английском языке](https://github.blog/2018-10-30-oct21-post-incident-analysis/).

### Ответ: 
#### Постмортем
```
Краткое описание инцидента
  21 октября в 22:52 UTC пострадали несколько сервисов на GitHub.com, несколько сетевых разделов c последующим сбоем базы данных, что привело к отображению устаревшей и непоследовательной информации.
Предшествующие события
  22:52 UTC 21 октября были произведены плановые работы по техническому обслуживанию для замены вышедшего из строя оптического оборудования 100G.
 После замена оптического кабеля произошла потеря связи между сетевым центром на Восточном побережье США и основным центром обработки данных на Восточном побережье США. 
Причина инцидента
  Кратковременное отключение связи (43 секунды) между сетевым центром на Восточном побережье США и основным центром обработки данных на Восточном побережье США. 
Воздействие
  Инцидент повлиял только на метаданные веб-сайтов, хранящиеся в базах данных MySQL, такие как Issue и PR
обнаружение
  21 октября 2018 22:54 UTC системы мониторинга начали генерировать оповещения, указывающие на то, что в системах наблюдались многочисленные сбои. К 23:02 UTC инженеры первого реагирования определили, что топологии для многочисленных кластеров баз данных находятся в неожиданном состоянии.
Реакция
  21 октября 2018 23:07 UTC команда реагирования решила вручную заблокировать внутренний инструмент развертывания. 
  23: 09 UTC команда реагирования присвоила сайту желтый статус. 
  23:11 UTC присоединился координатор инцидента и через две минуты изменил решение на красный статус.
Восстановление
 План восстановления данных из резервных копий, синхронизировать реплики на обоих сайтах, вернуться к стабильной топологии обслуживания, а затем возобновить обработку заданий, поставленных в очередь.
 Проинформировали пользователей о контролируемом переходе на другой ресурс внутренней системы хранения данных. 
 Произвели восстановление нескольких терабайт резервных копий. 
 Был запущен процесс резервного копирования для всех затронутых кластеров MySQL, и инженеры отслеживали прогресс. 
 Распределили нагрузку на чтение по большому пулу реплик чтения. 
 Во время инцидента начали предоставлять дополнительные реплики MySQL для чтения в общедоступном облаке Восточного побережья США. Как только реплики были синхронизированы, выполнили переход на исходную топологию, решив непосредственные проблемы с задержкой / доступностью. 
 Увеличили TTL на некоторое время. 
  22 октября 2018 23:03 UTC Все незавершенные сборки веб-страниц были обработаны, и целостность и надлежащая работа всех систем были подтверждены. Статус сайта был обновлен до зеленого.

Таймлайн
21 октября 22:52 UTC Аварийное переключение кластеров для направления операций записи в ЦОД на западном побережье США
21 октября 22:54 UTC Системы мониторинга начали генерировать предупреждения, указывающие на многочисленные сбои в системах
21 октября 23:07 UTC Команда решила вручную заблокировать внутренний инструмент развертывания, чтобы предотвратить внесение каких-либо дополнительных изменений
21 октября 23:13 UTC Были вызваны дополнительные инженеры из группы разработки баз данных GitHub
21 октября 23:19 UTC Приостановка доставки веб-перехватчика и сборки страниц GitHub
22 октября 00:05 UTC Разработка плана по устранению несоответствий данных и внедрения процедур аварийного переключения для MySQL
22 октября 00:41 UTC Инициирован процесс резервного копирования для всех затронутых кластеров MySQL
22 октября 06:51 UTC Несколько кластеров завершили восстановление из резервных копий в центре обработки данных на восточном побережье США и начали репликацию новых данных с западного побережья
22 октября 07:46 UTC GitHub опубликовал сообщение в блоге, чтобы предоставить больше информации
22 октября 11:12 UTC Все первичные базы данных снова установлены на восточном побережье США
22 октября 13:15 UTC Стали приближаться к пиковой нагрузке трафика на GitHub.com
22 октября 16:24 UTC Выполнено аварийное переключение на исходную топологию, решив проблемы с задержкой/доступностью
22 октября 16:45 UTC Балансировка возросшей нагрузки, созданной отставанием
22 октября 23:03 UTC Все задачи ожидающие сборки вебхуков и страниц были обработаны, и была подтверждена целостность и правильная работа всех систем

Последующие действия
  Изменение конфигурации Orchestrator, чтобы предотвратить распространение базы данных через региональные границы.
  Ускорить переход на новый механизм отчетов о состоянии, который предоставит более богатую площадку для обсуждения активных инцидентов, более четким и понятным языком
  Закончить работу, которая началась за несколько недель до инцидента. Работа по улучшению отказоустойчивости сервиса, чтобы система оставалась доступной даже при отказе целого датацентра.
  Проводить больше сценариев сбоев до того, как они смогут повлиять на пользователей.


```


